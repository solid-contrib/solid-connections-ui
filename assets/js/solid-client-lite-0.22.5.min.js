var SolidClient=function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}(function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(typeof t[e]){case"function":break;case"object":t[e]=function(e){var r=e.slice(1),i=t[e[0]];return function(t,e,n){i.apply(this,[t,e,n].concat(r))}}(t[e]);break;default:t[e]=t[t[e]]}return t}([function(t,e,r){t.exports=r(1)},function(t,e,r){"use strict";var i=r(2),n=r(4)(i),s=r(18),o=new s(n),a=r(20),u=r(26)(i),p=r(32),c={acl:p,AppRegistration:r(23),appRegistry:r(22),auth:o,config:r(38),currentUser:o.currentUser.bind(o),identity:r(20),login:o.login.bind(o),meta:r(39),rdflib:i,signup:o.signup.bind(o),status:r(41),typeRegistry:r(30),vocab:u,web:n};c.clearPermissions=function(t){return p.clearPermissions(t,n)},c.discoverWebID=function(t){return a.discoverWebID(t,n,u)},c.getPermissions=function(t){return p.getPermissions(t,n,i)},c.getProfile=function(t,e){return a.getProfile(t,e,n,i)},t.exports=c},function(t,e,r){"use strict";var i;i="undefined"!=typeof $rdf?$rdf:"undefined"!=typeof tabulator?tabulator.rdf:r(3),t.exports=i},function(t,e){t.exports=$rdf},function(t,e,r){"use strict";function i(t,e){this.rdf=t,this.vocab=d(t),this.config=e||a}function n(t,e){return new i(t,e)}var s="text/turtle;q=0.8,*/*;q=0.5",o="text/turtle",a=r(5),u=r(6).composePatchQuery,p=r(7),c=r(9),l=r(13),h=r(15),d=r(10);i.prototype.createContainer=function(t,e,r,i){return this.post(t,i,e,!0)},i.prototype.createResponse=function(t,e){var r=new p(this.rdf,t,e);return"get"===r.method&&r.isContainer()?new c(this.rdf,r.location,r):r},i.prototype.currentUrl=function(){return"undefined"!=typeof window?window.location.href:null},i.prototype.del=function(t){return this.solidRequest(t,"DELETE")},i.prototype.get=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.headers=e.headers||{},e.headers.Accept||(e.headers.Accept=s),this.solidRequest(t,"GET",e)},i.prototype.head=function(t,e){return this.solidRequest(t,"HEAD",e)},i.prototype.loadParsedGraphs=function(t,e){var r=this,i=t.map(function(t){return r.get(t,e).then(function(t){return t.parsedGraph()})["catch"](function(){return null}).then(function(e){return{uri:t,value:e}})});return Promise.all(i)},i.prototype.needsProxy=function(t){var e=this.currentUrl(),r=e&&"https:"===e.slice(0,6),i=t&&"http:"===t.slice(0,5);return r&&i},i.prototype.options=function(t){return this.solidRequest(t,"OPTIONS")},i.prototype.patch=function(t,e,r,i){var n=u(e,r),s="application/sparql-update";return i=i||{},i.headers=i.headers||{},i.headers["Content-Type"]=s,this.solidRequest(t,"PATCH",i,n)},i.prototype.post=function(t,e,r,i,n){var s;i?(s=this.vocab.ldp("BasicContainer"),n="text/turtle"):(s=this.vocab.ldp("Resource"),n=n||o);var a={};return a.headers={},a.headers.Link=s+'; rel="type"',a.headers["Content-Type"]=n,r&&r.length>0&&(a.headers.Slug=r),this.solidRequest(t,"POST",a,e)},i.prototype.proxyUrl=function(t,e){return e=e||this.config.proxyUrl,e.replace("{uri}",encodeURIComponent(t))},i.prototype.put=function(t,e,r,i){return i=i||{},i.headers=i.headers||{},r=r||o,i.headers["Content-Type"]=r,this.solidRequest(t,"PUT",i,e)},i.prototype.solidRequest=function(t,e,r,i){r=r||{},r.headers=r.headers||{},r.proxyUrl=r.proxyUrl||this.config.proxyUrl,r.timeout=r.timeout||this.config.timeout,(this.needsProxy(t)||r.forceProxy)&&(t=this.proxyUrl(t));var n=this;return new Promise(function(s,o){var a=new l;a.open(e,t),r.noCredentials||(a.withCredentials=!0);for(var u in r.headers)a.setRequestHeader(u,r.headers[u]);r.timeout&&(a.timeout=r.timeout),a.onload=function(){this.status>=200&&this.status<300?s(n.createResponse(this,e)):o(new h(this.status,this.statusText,{xhr:this}))},a.onerror=function(){o(new h(this.status,this.statusText,{xhr:this}))},"undefined"!=typeof i&&i?a.send(i):a.send()})},t.exports=n,t.exports.SolidWebClient=i},function(t,e){"use strict";t.exports={proxyUrl:"https://databox.me/,proxy?uri={uri}",timeout:5e4}},function(t,e){"use strict";function r(t,e){return e&&"http"!==e.slice(0,4)?[t,e].map(function(t){return"/"===t[0]&&(t=t.slice(1)),"/"===t[t.length-1]&&(t=t.slice(0,t.length-1)),t}).join("/"):e}function i(t,e){var r="",i=!0;return t&&t.length>0&&(t=t.map(function(t){return a(t,i)}),r+="DELETE DATA { "+t.join(" . ")+" };\n"),e&&e.length>0&&(e=e.map(function(t){return a(t,i)}),r+="INSERT DATA { "+e.join(" . ")+" };\n"),r}function n(t){var e,r,i,n,s=t.split("//");return 2===s.length?(e=s[0],r=s[1]):r=t,n=r.split("/"),i=e?e+"//"+n[0]:n[0],t.startsWith("//")&&(i="//"+i),i}function s(t,e){var r={};if(t){var i=t.split(",");i.forEach(function(e){e&&t.indexOf(e)>=0&&(r[e.trim().toLowerCase()]=!0)})}return e&&e.indexOf("application/sparql-update")>=0&&(r.patch=!0),r}function o(t){if(!t)return{};for(var e=/<[^>]*>\s*(\s*;\s*[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*")))*(,|$)/g,r=/[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*"))/g,i=t.match(e),n={},s=0;s<i.length;s++)for(var o=i[s].split(">"),a=o[0].substring(1),u=o[1],p=u.match(r),c=0;c<p.length;c++){var l=p[c],h=l.split("="),d=h[1].replace(/["']/g,"");n[d]||(n[d]=[]),n[d].push(a),n[d].length>1&&n[d].sort()}return n}function a(t,e){return"string"!=typeof t&&(t=t.toCanonical()),e&&t.endsWith(".")&&(t=t.slice(0,-1)),t}t.exports.absoluteUrl=r,t.exports.composePatchQuery=i,t.exports.hostname=n,t.exports.parseAllowedMethods=s,t.exports.parseLinkHeader=o,t.exports.statementToNT=a},function(t,e,r){"use strict";function i(t,e,r){if(!e)return this.xhr=null,this.user="",this.method=null,this.types=[],void(this.graph=null);this.rdf=t;var i=e.getResponseHeader("Link");this.linkHeaders=n.parseLinkHeader(i)||{},r=r?r.toLowerCase():"",this.method=r,this.acl=this.linkHeaders.acl,this.acl&&(this.acl=this.acl[0]),this.allowedMethods=this.parseAllowedMethods(e,r),this.graph=null,this.meta=this.linkHeaders.meta||this.linkHeaders.describedBy,this.meta&&(this.meta=this.meta[0]),this.types=this.typeLinkHeaders(),this.url=e.getResponseHeader("Location")||e.responseURL,this.user=e.getResponseHeader("User")||"",this.websocket=e.getResponseHeader("Updates-Via")||"",this.xhr=e}t.exports=i;var n=r(6),s=r(8);i.prototype.aclAbsoluteUrl=function(){return this.acl?this.resolveMetaOrAclUrl("acl"):null},i.prototype.contentType=function(){return this.xhr?this.xhr.getResponseHeader("Content-Type"):null},i.prototype.exists=function(){return this.xhr&&this.xhr.status>=200&&this.xhr.status<400},i.prototype.isContainer=function(){return this.isType("http://www.w3.org/ns/ldp#Container")||this.isType("http://www.w3.org/ns/ldp#BasicContainer")},i.prototype.isLoggedIn=function(){return this.user},i.prototype.isType=function(t){return this.types.indexOf(t)!==-1},i.prototype.metaAbsoluteUrl=function(){return this.meta?this.resolveMetaOrAclUrl("meta"):null},i.prototype.parseAllowedMethods=function(t,e){return"get"===e?{}:n.parseAllowedMethods(t.getResponseHeader("Allow"),t.getResponseHeader("Accept-Patch"))},i.prototype.parsedGraph=function(){return this.graph||(this.graph=s.parseGraph(this.rdf,this.url,this.raw(),this.contentType())),this.graph},i.prototype.raw=function(){return this.xhr?this.xhr.response:null},i.prototype.resolveMetaOrAclUrl=function(t){if(!this.url)return null;var e=this[t],r=this.url.slice(0,this.url.lastIndexOf("/")+1);return n.absoluteUrl(r,e)},i.prototype.typeLinkHeaders=function(){if(!Array.isArray(this.linkHeaders.type))return[];var t=new Set(this.linkHeaders.type||[]);return Array.from(t)}},function(t,e){"use strict";function r(t,e,r){e.statementsMatching(a).forEach(function(e){t.add(e.subject,e.predicate,e.object,e.why)})}function i(t,e){var r=t.graph();return e.forEach(function(t){r.addStatement(t)}),r}function n(t,e,r,i){var n=t.graph();return t.parse(r,n,e,i),n}function s(t,e,r,i,n){var s={},o=t.statementsMatching(e,r,i,n);return o.forEach(function(t){s[t.object.uri]=!0}),Object.keys(s)}function o(t){var e=t.map(function(t){return t.toNT()});return e=e.join("\n")}t.exports.appendGraph=r,t.exports.parseGraph=n,t.exports.parseLinks=s,t.exports.serializeStatements=o,t.exports.graphFromStatements=i;var a=null},function(t,e,r){"use strict";function i(t,e,r){a.call(this,e,r),this.containers={},this.contentsUris=[],this.rdf=t,this.resources={},this.vocab=o(t),r&&this.initFromResponse(this.uri,r)}t.exports=i;var n=r(8),s=n.parseLinks,o=r(10),a=r(12);i.prototype=Object.create(a.prototype),i.prototype.constructor=i,i.prototype.appendFromGraph=function(t,e){var r=this.rdf.namedNode(this.uri);this.types=Object.keys(t.findTypeURIs(r));var n=s(t,null,this.vocab.ldp("contains"));this.contentsUris=this.contentsUris.concat(n.sort());var o,u=t.each(null,null,this.vocab.ldp("Container")),p=this;u.forEach(function(e){e.uri!==p.uri&&(o=new i(p.rdf,e.uri),o.types=Object.keys(t.findTypeURIs(e)),p.containers[o.uri]=o)});var c,l,h,d;n.forEach(function(e){l=e in p.containers,c=e!==p.uri&&!l,c&&(h=new a(e),d=p.rdf.namedNode(e),h.types=Object.keys(t.findTypeURIs(d)),p.resources[e]=h)})},i.prototype.findByType=function(t){var e,r,i=[];for(e in this.containers)r=this.containers[e],r.isType(t)&&i.push(r);var n;for(e in this.resources)n=this.resources[e],n.isType(t)&&i.push(n);return i},i.prototype.initFromResponse=function(t,e){var r=e.contentType();if(!r)throw new Error("Cannot parse container without a Content-Type: header");var i=n.parseGraph(this.rdf,t,e.raw(),r);this.parsedGraph=i,this.appendFromGraph(i,t)},a.prototype.isContainer=function(){return!0},i.prototype.isEmpty=function(){return 0===this.contentsUris.length}},function(t,e,r){"use strict";function i(t){var e=r(11)(t),i={acl:e.base("http://www.w3.org/ns/auth/acl#"),app:e.base("http://www.w3.org/ns/solid/app#"),dct:e.base("http://purl.org/dc/terms/"),foaf:e.base("http://xmlns.com/foaf/0.1/"),ldp:e.base("http://www.w3.org/ns/ldp#"),owl:e.base("http://www.w3.org/2002/07/owl#"),pim:e.base("http://www.w3.org/ns/pim/space#"),rdf:e.base("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),rdfs:e.base("http://www.w3.org/2000/01/rdf-schema#"),schema:e.base("http://schema.org/"),sioc:e.base("http://rdfs.org/sioc/ns#"),solid:e.base("http://www.w3.org/ns/solid/terms#"),vcard:e.base("http://www.w3.org/2006/vcard/ns#"),xsd:e.base("http://www.w3.org/2001/XMLSchema#")};return i}t.exports=i},function(t,e){"use strict";function r(t){this.rdf=t}function i(t){return new r(t)}t.exports=i,r.prototype.base=function(t){var e=this;return function(r){return e.rdf?e.rdf.namedNode(t+r):t+r}}},function(t,e){"use strict";function r(t,e){this.name=null,this.parsedGraph=null,this.response=e,this.types=[],this.uri=t,e&&e.url!==t&&(this.uri=e.url),this.initName()}t.exports=r,r.prototype.initName=function(){if(this.uri){var t=this.uri.split("/");this.name=t.pop(),!this.name&&t.length>0&&(this.name=t.pop())}},r.prototype.isContainer=function(){return!1},r.prototype.isType=function(t){return this.types.indexOf(t)!==-1}},function(t,e,r){"use strict";var i;i="undefined"!=typeof tabulator&&tabulator.isExtension?Components.classes["@mozilla.org/xmlextras/xmlhttprequest;1"].createInstance().QueryInterface(Components.interfaces.nsIXMLHttpRequest):"undefined"!=typeof window&&"XMLHttpRequest"in window?window.XMLHttpRequest:r(14),t.exports=i},function(t,e){t.exports=XMLHttpRequest},function(t,e,r){function i(t,e,r){if("string"==typeof t&&(t=a[t]),"number"!=typeof t)throw new TypeError("Non-numeric HTTP code");"object"==typeof e&&null!=e&&(r=e,e=null),s.call(this,e||o[t],r),this.code=t}function n(t){return{configurable:!0,get:function(){return this[t]},set:function(e){return this[t]=e}}}e=t.exports=i;var s=r(16),o=r(17),a=e;i.prototype=Object.create(s.prototype,{constructor:{value:i,configurable:!0,writable:!0}}),i.prototype.name="HttpError",Object.defineProperties(i.prototype,{statusCode:n("code"),statusMessage:n("message"),status:{configurable:!0,get:function(){return this.code},set:function(t){Object.defineProperty(this,"status",{value:t,configurable:!0,enumerable:!0,writable:!0})}}}),i.prototype.toString=function(){return this.name+": "+this.code+" "+this.message};for(var u in o){var p=o[u];e[p.replace("'","").replace(/[- ]/g,"_").toUpperCase()]=+u}},function(t,e){function r(t,e){if(t&&"object"==typeof t?(e=t,t=void 0):this.message=t,e)for(var r in e)this[r]=e[r];i.call(this,"name")||(this.name=i.call(n(this),"name")?this.name:this.constructor.name),!s||"stack"in this||s(this,this.constructor)}var i=Object.hasOwnProperty,n=Object.getPrototypeOf,s=Error.captureStackTrace;t.exports=r,r.prototype=Object.create(Error.prototype,{constructor:{value:r,configurable:!0,writable:!0}}),r.prototype.name="StandardError"},function(t,e){t.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},function(t,e,r){"use strict";function i(t,e){this.webClient=t,this.config=e||n}t.exports=i;var n=r(19);i.prototype.currentUser=function(){if("undefined"==typeof window)return null;var t=window.location.href;return this.login(t)["catch"](function(t){return console.log("Detecting current user failed: %o",t),null})},i.prototype.listen=function(){var t=new Promise(function(t,e){var r=window.addEventListener?"addEventListener":"attachEvent",i=window[r],n="attachEvent"===r?"onmessage":"message";i(n,function(r){var i=r.data;if("User:"===i.slice(0,5)){var n=i.slice(5,i.length);return n&&n.length>0&&"http"===n.slice(0,4)?t(n):e(n)}},!0)});return t},i.prototype.login=function(t,e){var r=this.config.authEndpoint;t=t||window.location.origin+window.location.pathname,e=e||r;var i=this.webClient;return i.head(t).then(function(t){return t.isLoggedIn()?t.user:i.head(e).then(function(t){return t.user})})},i.prototype.signup=function(t){t=t||this.config.signupEndpoint;var e=this.config.signupWindowWidth,r=this.config.signupWindowHeight,i=window.screen.width/2-(e/2+10),n=window.screen.height/2-(r/2+50),s="Solid signup",o=t+"?origin="+encodeURIComponent(window.location.origin),a="resizable,scrollbars,status,width="+e+",height="+r+",left="+i+",top="+n;window.open(o,s,a);var u=this;return new Promise(function(t){u.listen().then(function(e){return t(e)})})}},function(t,e){"use strict";t.exports={authEndpoint:"https://databox.me/",signupEndpoint:"https://solid.github.io/solid-idps/",signupWindowHeight:600,signupWindowWidth:1024}},function(t,e,r){"use strict";function i(t,e,r){return e.options(t).then(function(t){var r=t.metaAbsoluteUrl();if(!r)throw new Error("Could not find a meta URL in the Link header");return e.get(r)}).then(function(e){var i=e.parsedGraph(),n=i.any(void 0,r.solid("account"));if(!n||!n.uri)throw new Error("Could not find a WebID matching the domain "+t);return n})}function n(t,e,r,i){return e=e||{},e.headers=e.headers||{Accept:"text/turtle"},e.noCredentials=!0,r.get(t,e).then(function(n){var a=n.parsedGraph(),u=new o(t,a,i,r,n);return u.isLoaded=!0,e.ignoreExtended?u:s(u,e,r)})}function s(t,e,r){var i=t.relatedProfilesLinks();return r.loadParsedGraphs(i,e).then(function(e){return e.forEach(function(e){e&&e.value&&t.appendFromGraph(e.value,e.uri)}),t})}t.exports.discoverWebID=i,t.exports.getProfile=n,t.exports.loadExtendedProfile=s;var o=r(21)},function(t,e,r){"use strict";function i(t,e,r,i,n){this.appRegistryListed={uri:null,graph:null},this.appRegistryUnlisted={uri:null,graph:null},this.inbox={uri:null,graph:null},this.isLoaded=!1,this.picture=null,this.name=null,this.rdf=r,this.storage=[],this.typeIndexListed={uri:null,graph:null},this.typeIndexUnlisted={uri:null,graph:null},this.parsedGraph=null,this.preferences={uri:null,graph:null},this.response=n,this.relatedProfiles={sameAs:[],seeAlso:[]},this.webId=null,this.webClient=i,t&&(this.baseProfileUrl=t.indexOf("#")>=0?t.slice(0,t.indexOf("#")):t,e&&(this.initWebId(e),this.appendFromGraph(e,this.baseProfileUrl)))}function n(t,e,r){var i=a(r),n=r.namedNode(t),s=i.foaf("primaryTopic"),o=e.any(n,s);return o}function s(t,e,r,i,n){var s=t.any(e,r,i,n);return s?s.uri:null}t.exports=i;var o=r(22),a=r(26),u=r(27),p=r(30),c=r(28),l=c.parseLinks,h="/settings/prefs.ttl",d="/profile/";i.prototype.appendFromGraph=function(t,e){if(t){var r=this.rdf,i=a(r);this.parsedGraph=this.parsedGraph||r.graph(),c.appendGraph(this.parsedGraph,t,e);var n,o=r.namedNode(this.webId);this.name||(this.name=this.find(i.foaf("name"))),this.picture||(this.picture=this.find(i.foaf("img"))),n=l(t,null,i.owl("sameAs")),this.relatedProfiles.sameAs=this.relatedProfiles.sameAs.concat(n),n=l(t,null,i.rdfs("seeAlso")),this.relatedProfiles.seeAlso=this.relatedProfiles.seeAlso.concat(n),this.preferences.uri||(this.preferences.uri=s(t,o,i.pim("preferencesFile"))),this.inbox.uri||(this.inbox.uri=s(t,o,i.solid("inbox"))),n=l(t,o,i.pim("storage")),this.storage=this.storage.concat(n),this.typeIndexListed.uri||(this.typeIndexListed.uri=s(t,o,i.solid("publicTypeIndex"))),this.typeIndexUnlisted.uri||(this.typeIndexUnlisted.uri=s(t,o,i.solid("privateTypeIndex"))),this.appRegistryListed.uri||(this.appRegistryListed.uri=s(t,o,i.solid("publicAppRegistry"))),this.appRegistryUnlisted.uri||(this.appRegistryUnlisted.uri=s(t,o,i.solid("privateAppRegistry")))}},i.prototype.appRegistryDefaultContainer=function(){var t,e=this.webId||this.baseProfileUrl;return t=e?e.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"")+"/":d},i.prototype.appsForType=function(t){return o.appsForType(this,t,this.rdf)},i.prototype.find=function(t){if(!this.parsedGraph)throw new Error("Profile graph not yet loaded.");var e=this.rdf.namedNode(this.webId),r=this.parsedGraph.any(e,t);return r?r.value||r.uri:r},i.prototype.findAll=function(t){if(!this.parsedGraph)throw new Error("Profile graph not yet loaded.");var e=this.rdf.namedNode(this.webId),r=this.parsedGraph.statementsMatching(e,t);return r=r.map(function(t){return t.object.value||t.object.uri}),r.sort()},i.prototype.initWebId=function(t){if(t)try{this.webId=n(this.baseProfileUrl,t,this.rdf).uri}catch(e){throw new Error("Unable to parse WebID from profile: "+e)}},i.prototype.relatedProfilesLinks=function(){var t=[];return t=t.concat(this.relatedProfiles.sameAs).concat(this.relatedProfiles.seeAlso),this.preferences.uri&&(t=t.concat(this.preferences.uri)),t},i.prototype.hasAppRegistryPrivate=function(){if(!this.isLoaded)throw new Error("Must load profile before checking if registry exists.");return this.appRegistryUnlisted.uri},i.prototype.hasAppRegistryPublic=function(){if(!this.isLoaded)throw new Error("Must load profile before checking if registry exists.");return this.appRegistryListed.uri},i.prototype.hasStorage=function(){return this.storage&&this.storage.length>0},i.prototype.hasTypeRegistryPrivate=function(){if(!this.isLoaded)throw new Error("Must load profile before checking if registry exists.");return this.typeIndexUnlisted.uri},i.prototype.hasTypeRegistryPublic=function(){if(!this.isLoaded)throw new Error("Must load profile before checking if registry exists.");return this.typeIndexListed.uri},i.prototype.loadAppRegistry=function(t,e){return t=t||this.webClient,o.loadAppRegistry(this,t,e)},i.prototype.loadTypeRegistry=function(t,e){return t=t||this.webClient,p.loadTypeRegistry(this,t,e)},i.prototype.addAppRegistry=function(t,e){if(u.isListed(t,this.rdf))this.appRegistryListed.graph||(this.appRegistryListed.uri=e,this.appRegistryListed.graph=t);else{if(!u.isUnlisted(t,this.rdf))throw console.log(t),new Error("Attempting to add an invalid app registry resource");this.appRegistryUnlisted.graph||(this.appRegistryUnlisted.uri=e,this.appRegistryUnlisted.graph=t)}},i.prototype.addTypeRegistry=function(t,e){if(u.isListed(t,this.rdf))this.typeIndexListed.graph||(this.typeIndexListed.uri=e,this.typeIndexListed.graph=t);else{if(!u.isUnlisted(t,this.rdf))throw new Error("Attempting to add an invalid type registry index");this.typeIndexUnlisted.graph||(this.typeIndexUnlisted.uri=e,this.typeIndexUnlisted.graph=t)}},i.prototype.reloadAppRegistry=function(t){return this.resetAppRegistry(),this.loadAppRegistry(t)},i.prototype.reloadTypeRegistry=function(t){return this.resetTypeRegistry(),this.loadTypeRegistry(t)},i.prototype.resetAppRegistry=function(){this.appRegistryListed.graph=null,this.appRegistryUnlisted.graph=null},i.prototype.resetTypeRegistry=function(){this.typeIndexListed.graph=null,this.typeIndexUnlisted.graph=null},i.prototype.typeRegistryForClass=function(t){return p.typeRegistryForClass(this,t,this.rdf)},i.prototype.typeRegistryDefaultContainer=function(){var t,e=this.webId||this.baseProfileUrl;return t=e?e.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"")+"/":d},i.prototype.privateProfileUri=function(){return this.preferences&&this.preferences.uri?this.preferences.uri:h},i.prototype.registerApp=function(t,e){return e=e||this.webClient,o.registerApp(this,t,e)},i.prototype.registerType=function(t,e,r,i){return p.registerType(this,t,e,r,i,this.webClient)},i.prototype.unregisterType=function(t,e,r){return p.unregisterType(this,t,e,r,this.webClient)}},function(t,e,r){"use strict";function i(t,e,r){var i,n;if(e.isListed?(i=t.appRegistryListed.uri,n=t.appRegistryListed.graph):(i=t.appRegistryUnlisted.uri,n=t.appRegistryUnlisted.graph),!i)throw new Error("Cannot register app, registry URL missing");var s=t.rdf,o=[],a=e.rdfStatements(s);return r.patch(i,o,a).then(function(e){var r=d.graphFromStatements(a,s);return n?d.appendGraph(n,r):n=r,t})}function n(t,e,r){var i=[];return i.concat(l(t.appRegistryListed.graph,e,r)).concat(l(t.appRegistryUnlisted.graph,e,r))}function s(t){var e=g(t),r=t.namedNode(""),i=[t.triple(r,e.rdf("type"),e.solid("AppRegistry")),t.triple(r,e.rdf("type"),e.solid("UnlistedDocument"))],n={data:d.serializeStatements(i),graph:d.graphFromStatements(i,t),slug:"privateAppRegistry.ttl",uri:null};return n}function o(t){var e=g(t),r=t.namedNode(""),i=[t.triple(r,e.rdf("type"),e.solid("AppRegistry")),t.triple(r,e.rdf("type"),e.solid("ListedDocument"))],n={data:d.serializeStatements(i),graph:d.graphFromStatements(i,t),slug:"publicAppRegistry.ttl",uri:null};return n}function a(t,e,r){r=r||{};var i=t.rdf,n=g(i),o=t.appRegistryDefaultContainer(),a=i.namedNode(t.webId),u=s(i);return e.post(o,u.data,u.slug)["catch"](function(t){throw new Error("Could not create private registry document:",t)}).then(function(s){u.uri=f.absoluteUrl(y.hostname(o),s.url);var p=[i.triple(a,n.solid("privateAppRegistry"),i.namedNode(u.uri))],c=[];return e.patch(t.privateProfileUri(),c,p,r)})["catch"](function(t){throw new Error("Could not update profile with private registry:"+t)}).then(function(e){return t.appRegistryUnlisted=u,t})}function u(t,e,r){r=r||{};var i=t.rdf,n=g(i),s=t.appRegistryDefaultContainer(),a=i.namedNode(t.webId),u=o(i);return e.post(s,u.data,u.slug)["catch"](function(t){throw new Error("Could not create public registry document:",t)}).then(function(o){u.uri=f.absoluteUrl(y.hostname(s),o.url);var p=[i.triple(a,n.solid("publicAppRegistry"),i.namedNode(u.uri))],c=[];return e.patch(t.webId,c,p,r)})["catch"](function(t){throw new Error("Could not update profile with public registry:",t)}).then(function(e){return t.appRegistryListed=u,t})}function p(t,e,r){r=r||{},r.headers=r.headers||{},r.headers.Accept||(r.headers.Accept="text/turtle");var i=[];return t.appRegistryListed.uri&&i.push(t.appRegistryListed.uri),t.appRegistryUnlisted.uri&&i.push(t.appRegistryUnlisted.uri),e.loadParsedGraphs(i,r).then(function(e){return e.forEach(function(e){e&&e.value&&t.addAppRegistry(e.value,e.uri)}),t})}function c(t,e,r){if(!t)throw new Error("No profile provided");if(!t.isLoaded)throw new Error("Profile is not loaded");if(!e||!e.isValid())throw new Error("Invalid app registration");return p(t,r).then(function(t){return e.isListed&&!t.hasAppRegistryPublic()?u(t,r):e.isListed||t.hasAppRegistryPrivate()?t:a(t,r)}).then(function(t){return i(t,e,r)})}function l(t,e,r){var i,n=g(r),s=[];return t?(t.statementsMatching(null,n.app("commonType"),e).forEach(function(e){i=e.subject;var n=new h;n.initFromGraph(i,t,r),s.push(n)}),s):s}t.exports.addToAppRegistry=i,t.exports.blankPrivateAppRegistry=s,t.exports.blankPublicAppRegistry=o,t.exports.initAppRegistryPrivate=a,t.exports.initAppRegistryPublic=u,t.exports.loadAppRegistry=p,t.exports.appsForType=n,t.exports.registerApp=c,t.exports.registrationsFromGraph=l;var h=r(23),d=r(28),f=r(29),g=r(26),y=r(29)},function(t,e,r){"use strict";function i(t,e,r){t=t||{},this.isListed=r,this.name=t.name,this.redirectTemplateUri=t.redirectTemplateUri,this.registrationUri=null,this.shortdesc=t.shortdesc,this.types=e||[]}t.exports=i;var n=r(24),s=r(26),o=r(27);i.prototype.hashFragment=function(){var t=n.unique(this.redirectTemplateUri);return t},i.prototype.initFromGraph=function(t,e,r){this.registrationUri=t.uri,this.isListed=!!o.isListed(e,r),this.types=[];var i=this,n=s(r);e.statementsMatching(t,n.app("commonType")).forEach(function(t){i.types.push(t.object.uri)});var a;a=e.any(t,n.app("name")),a&&(this.name=a.value),a=e.any(t,n.app("shortdesc")),a&&(this.shortdesc=a.value),a=e.any(t,n.app("redirectTemplateUri")),a&&(this.redirectTemplateUri=a.value)},i.prototype.isValid=function(){return this.name&&this.redirectTemplateUri&&this.types.length>0},i.prototype.rdfStatements=function(t){var e=t.namedNode("#"+this.hashFragment()),r=[],i=s(t);return r.push(t.triple(e,i.rdf("type"),i.solid("AppRegistration")),t.triple(e,i.app("name"),this.name),t.triple(e,i.app("shortdesc"),this.shortdesc),t.triple(e,i.app("redirectTemplateUri"),this.redirectTemplateUri)),this.types.forEach(function(n){r.push(t.triple(e,i.app("commonType"),n))}),r}},function(t,e,r){t.exports=r(25)},function(t,e){function r(t){var e=0;if(0==t.length)return e;for(var r=0;r<t.length;r++){var i=t.charCodeAt(r);e=(e<<5)-e+i,e&=e}return e}function i(t,e){function r(t){var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";return e[t]}e=e||62;var i,n=[],s="",o=t<0?"-":"";for(t=Math.abs(t);t>=e;)i=t%e,t=Math.floor(t/e),n.push(r(i));t>0&&n.push(r(t));for(var a=n.length-1;a>=0;a--)s+=n[a];return o+s}function n(t){var e=i(r(t),61);return e.replace("-","Z")}function s(t){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",r="",i=t||8,n=0;n<i;n++){var s=Math.floor(Math.random()*e.length);r+=e.substring(s,s+1)}return r}e.bitwise=r,e.binaryTransfer=i,e.unique=n,e.random=s},[42,11],function(t,e,r){"use strict";function i(t,e){var r=s(e);return t.any(null,null,r.solid("UnlistedDocument"),t.uri)}function n(t,e){var r=s(e);return t.any(null,null,r.solid("ListedDocument"),t.uri)}t.exports.isListed=n,t.exports.isUnlisted=i;var s=r(26)},function(t,e){"use strict";function r(t,e){e.statementsMatching(u).forEach(function(e){t.add(e.subject,e.predicate,e.object,e.why)})}function i(t,e){return"string"!=typeof t&&(t=t.toNT()),e&&t.endsWith(".")&&(t=t.slice(0,-1)),t}function n(t,e){var r=e.graph();return t.forEach(function(t){r.addStatement(t)}),r}function s(t,e,r,i){var n=i.graph();return i.parse(e,n,t,r),n}function o(t,e,r,i,n){var s={},o=t.statementsMatching(e,r,i,n);return o.forEach(function(t){s[t.object.uri]=!0}),Object.keys(s)}function a(t){var e=t.map(function(t){return t.toNT()});return e=e.join("\n")}t.exports.appendGraph=r,t.exports.parseGraph=s,t.exports.parseLinks=o,t.exports.serializeStatements=a,t.exports.graphFromStatements=n,t.exports.statementToNT=i;var u=null},function(t,e,r){"use strict";function i(t,e){var r={};if(t){var i=t.split(",");i.forEach(function(e){e&&t.indexOf(e)>=0&&(r[e.trim().toLowerCase()]=!0)})}return e&&e.indexOf("application/sparql-update")>=0&&(r.patch=!0),r}function n(t){if(!t)return{};for(var e=/<[^>]*>\s*(\s*;\s*[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*")))*(,|$)/g,r=/[^\(\)<>@,;:"\/\[\]\?={} \t]+=(([^\(\)<>@,;:"\/\[\]\?={} \t]+)|("[^"]*"))/g,i=t.match(e),n={},s=0;s<i.length;s++)for(var o=i[s].split(">"),a=o[0].substring(1),u=o[1],p=u.match(r),c=0;c<p.length;c++){var l=p[c],h=l.split("="),d=h[1].replace(/["']/g,"");n[d]||(n[d]=[]),n[d].push(a),n[d].length>1&&n[d].sort()}return n}function s(t){var e,r,i,n,s=t.split("//");return 2===s.length?(e=s[0],r=s[1]):r=t,n=r.split("/"),i=e?e+"//"+n[0]:n[0],t.startsWith("//")&&(i="//"+i),i}function o(t,e){return e&&"http"!==e.slice(0,4)?[t,e].map(function(t){return"/"===t[0]&&(t=t.slice(1)),"/"===t[t.length-1]&&(t=t.slice(0,t.length-1)),t}).join("/"):e}function a(t,e){var r="",i=!0;return t&&t.length>0&&(t=t.map(function(t){return u.statementToNT(t,i)}),r+="DELETE DATA { "+t.join(" . ")+" };\n"),e&&e.length>0&&(e=e.map(function(t){return u.statementToNT(t,i)}),r+="INSERT DATA { "+e.join(" . ")+" };\n"),r}t.exports.composePatchQuery=a,t.exports.parseAllowedMethods=i,t.exports.parseLinkHeader=n,t.exports.absoluteUrl=o,t.exports.hostname=s;var u=r(28)},function(t,e,r){"use strict";function i(t){var e=t.namedNode(""),r=v(t),i=[t.triple(e,r.rdf("type"),r.solid("TypeIndex")),t.triple(e,r.rdf("type"),r.solid("UnlistedDocument"))],n={data:y.serializeStatements(i),graph:y.graphFromStatements(i,t),slug:"privateTypeIndex.ttl",uri:null};return n}function n(t){var e=t.namedNode(""),r=v(t),i=[t.triple(e,r.rdf("type"),r.solid("TypeIndex")),t.triple(e,r.rdf("type"),r.solid("ListedDocument"))],n={data:y.serializeStatements(i),graph:y.graphFromStatements(i,t),slug:"publicTypeIndex.ttl",uri:null};return n}function s(t,e,r){r=r||{};var n=e.rdf,s=v(n),o=t.typeRegistryDefaultContainer(),a=n.namedNode(t.webId),u=i(n);return e.post(o,u.data,u.slug)["catch"](function(t){throw new Error("Could not create privateIndex document:",t)}).then(function(i){u.uri=g.absoluteUrl(m.hostname(o),i.url);var p=[n.triple(a,s.solid("privateTypeIndex"),n.namedNode(u.uri))],c=[];return e.patch(t.privateProfileUri(),c,p,r)})["catch"](function(t){throw new Error("Could not update profile with private index:"+t)}).then(function(e){return t.typeIndexUnlisted=u,t})}function o(t,e,r){r=r||{};var i=e.rdf,s=v(i),o=t.typeRegistryDefaultContainer(),a=i.namedNode(t.webId),u=n(i);return e.post(o,u.data,u.slug)["catch"](function(t){throw new Error("Could not create publicIndex document:",t)}).then(function(n){u.uri=g.absoluteUrl(m.hostname(o),n.url);var p=[i.triple(a,s.solid("publicTypeIndex"),i.namedNode(u.uri))],c=[];return e.patch(t.webId,c,p,r)})["catch"](function(t){throw console.log(t),new Error("Could not update profile with public index:",t)}).then(function(e){return t.typeIndexListed=u,t})}function a(t,e,i,n,s,o){var a,u,p=r(24),c=n.rdf,l=v(c),h=p.unique(e.uri);if(o?(a=t.typeIndexListed.uri,u=t.typeIndexListed.graph):(a=t.typeIndexUnlisted.uri,u=t.typeIndexUnlisted.graph),!a)throw new Error("Cannot register type, registry URL missing");var d,f=c.namedNode(a+"#"+h);"instance"===s?d=l.solid("instance"):(d=l.solid("instanceContainer"),i.lastIndexOf("/")!==i.length-1&&(i+="/"));var g=[],m=[c.triple(f,l.rdf("type"),l.solid("TypeRegistration")),c.triple(f,l.solid("forClass"),e),c.triple(f,d,c.namedNode(i))];
return n.patch(a,g,m).then(function(e){var r=y.graphFromStatements(m,c);return u?y.appendGraph(u,r):u=r,t})}function u(t,e,r){r=r||{},r.headers=r.headers||{},r.headers.Accept||(r.headers.Accept="text/turtle");var i=[];return t.typeIndexListed.uri&&i.push(t.typeIndexListed.uri),t.typeIndexUnlisted.uri&&i.push(t.typeIndexUnlisted.uri),e.loadParsedGraphs(i,r).then(function(e){return e.forEach(function(e){e&&e.value&&t.addTypeRegistry(e.value,e.uri)}),t})}function p(t,e,r,i,n,p){if(!t)throw new Error("No profile provided");if(!t.isLoaded)throw new Error("Profile is not loaded");if(!e||!r)throw new Error("Type registration requires type class and location");if(i=i||"container","container"!==i&&"instance"!==i)throw new Error("Invalid location type");return u(t,p).then(function(t){return n&&!t.hasTypeRegistryPublic()?o(t,p):n||t.hasTypeRegistryPrivate()?t:s(t,p)}).then(function(t){return a(t,e,r,p,i,n)})}function c(t,e,r){var i=[],n=!0;return i.concat(l(t.typeIndexListed.graph,e,n,r)).concat(l(t.typeIndexUnlisted.graph,e,!n,r))}function l(t,e,r,i){var n,s,o,a=v(i),u=[];if(!t)return u;var p=t.statementsMatching(null,null,e);return p.forEach(function(i){n=i.subject,s=t.statementsMatching(n,a.solid("instance")),s.forEach(function(t){u.push(new f(n.uri,e,"instance",t.object.uri,r))}),o=t.statementsMatching(n,a.solid("instanceContainer")),o.forEach(function(t){u.push(new f(n.uri,e,"container",t.object.uri,r))})}),u}function h(t,e,r,i,n){var s,o,a=r.rdf;if(i?(s=t.typeIndexListed.uri,o=t.typeIndexListed.graph):(s=t.typeIndexUnlisted.uri,o=t.typeIndexUnlisted.graph),!s)throw new Error("Cannot unregister type, registry URL missing");var u=l(o,e,i,a);if(0===u.length)return Promise.resolve(t);n&&(u=u.filter(function(t){return t.locationUri===n}));var p=[];u.forEach(function(t){o.statementsMatching(a.namedNode(t.registrationUri)).forEach(function(t){p.push(t)})});var c=[];return r.patch(s,p,c).then(function(e){return t.reloadTypeRegistry(r)})}function d(t,e,r,i,n){if(!t)throw new Error("No profile provided");if(!t.isLoaded)throw new Error("Profile is not loaded");if(!e)throw new Error("Unregistering a type requires type class");return u(t,n).then(function(t){if(r&&!t.typeIndexListed.graph)throw new Error("Profile has no Listed type index");if(!r&&!t.typeIndexUnlisted.graph)throw new Error("Profile has no Unlisted type index");return h(t,e,n,r,i)})}t.exports.blankPrivateTypeIndex=i,t.exports.blankPublicTypeIndex=n,t.exports.initTypeRegistryPrivate=s,t.exports.initTypeRegistryPublic=o,t.exports.loadTypeRegistry=u,t.exports.registerType=p,t.exports.typeRegistryForClass=c,t.exports.unregisterType=d;var f=r(31),g=r(29),y=r(28),m=r(29),v=r(26)},function(t,e){"use strict";function r(t,e,r,i,n){this.isListed=n,this.locationType=r,this.locationUri=i,this.rdfClass=e,this.registrationUri=t}t.exports=r,r.prototype.isContainer=function(){return"container"===this.locationType},r.prototype.isInstance=function(){return"instance"===this.locationType}},function(t,e,r){"use strict";function i(t,e){var r;return e.head(t).then(function(t){if(r=t.aclAbsoluteUrl(),!r)throw new Error("ACL URL not found for resource.");return e.del(r)})}function n(t,e,r){var i,n;return e.head(t).then(function(o){if(i=o.aclAbsoluteUrl(),!i)throw new Error("ACL URL not found for resource.");return n=new s(t,i,o.isContainer(),{rdf:r,webClient:e}),e.get(i).then(function(t){return t.parsedGraph()})}).then(function(t){return n.initFromGraph(t),n})}var s=r(33),o=r(34),a=r(37);t.exports.clearPermissions=i,t.exports.getPermissions=n,t.exports.PermissionSet=s,t.exports.Authorization=o,Object.assign(t.exports,a.acl)},function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t){return s(t)?t:t+h}function s(t){return t.endsWith(h)}function o(t){return"string"==typeof t?t.startsWith("mailto:"):t.object.value.startsWith("mailto:")}var a=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),u=r(34),p=r(37),c=p.acl,l=r(35),h=".acl",d="text/turtle",f="resource",g="container",y="agents",m="groups",v=function(){function t(e,r,o){var a=arguments.length<=3||void 0===arguments[3]?{}:arguments[3];i(this,t),this.authorizations={},this.aclUrl=r,this.host=a.host,this.index={agents:{},groups:{}},this.rdf=a.rdf,this.resourceType=o?g:f,this.resourceUrl=e,this.strictOrigin=a.strictOrigin,this.origin=a.origin,this.webClient=a.webClient,this.aclUrlFor=a.aclUrlFor?a.aclUrlFor:n,this.aclUrlFor.bind(this),this.isAcl=a.isAcl?a.isAcl:s,this.isAcl.bind(this),a.graph&&this.initFromGraph(a.graph)}return a(t,[{key:"addAuthorization",value:function(t){var e=t.hashFragment();return e in this.authorizations?this.authorizations[e].mergeWith(t):this.authorizations[e]=t,!t.virtual&&t.allowsControl()&&this.addControlPermissionsFor(t),this.addToAgentIndex(t.webId(),t.accessType,t.resourceUrl,t),t.isPublic()&&this.addToPublicIndex(t.resourceUrl,t.accessType,t),this}},{key:"addAuthorizationFor",value:function(t,e,r,i){var n=arguments.length<=4||void 0===arguments[4]?[]:arguments[4],s=arguments.length<=5||void 0===arguments[5]?[]:arguments[5],o=new u(t,e);return o.setAgent(r),o.addMode(i),o.addOrigin(n),s.forEach(function(t){o.addMailTo(t)}),this.addAuthorization(o),o}},{key:"addControlPermissionsFor",value:function(t){var e=t.clone();e.resourceUrl=this.aclUrlFor(t.resourceUrl),e.virtual=!0,e.addMode(c.ALL_MODES),this.addAuthorization(e)}},{key:"addGroupPermission",value:function(t,e){var r=new u(this.resourceUrl,this.isAuthInherited());return r.setGroup(t),r.addMode(e),this.addAuthorization(r),this}},{key:"addPermission",value:function(t,e,r){if(!t)throw new Error("addPermission() requires a valid webId");if(!e)throw new Error("addPermission() requires a valid accessMode");var i=new u(this.resourceUrl,this.isAuthInherited());return i.setAgent(t),i.addMode(e),r&&i.addOrigin(r),this.addAuthorization(i),this}},{key:"addToAgentIndex",value:function(t,e,r,i){var n=this.index.agents;n[t]||(n[t]={}),n[t][e]||(n[t][e]={}),n[t][e][r]?n[t][e][r].mergeWith(i):n[t][e][r]=i}},{key:"addToGroupIndex",value:function(t,e,r,i){var n=this.index.groups;n[t]||(n[t]={}),n[t][e]||(n[t][e]={}),n[t][e][r]?n[t][e][r].mergeWith(i):n[t][e][r]=i}},{key:"addToPublicIndex",value:function(t,e,r){this.addToGroupIndex(c.EVERYONE,e,t,r)}},{key:"allAuthorizations",value:function(){var t,e=this,r=[];return Object.keys(this.authorizations).forEach(function(i){t=e.authorizations[i],r.push(t)}),r}},{key:"allowsPublic",value:function(t,e){e=e||this.resourceUrl;var r=this.findPublicAuth(e);return!!r&&(this.checkOrigin(r)&&r.allowsMode(t))}},{key:"buildGraph",value:function(t){var e=t.graph();return this.allAuthorizations().forEach(function(r){e.add(r.rdfStatements(t))}),e}},{key:"checkAccess",value:function(t,e,r){var i=void 0;if(this.allowsPublic(r,t))i=!0;else{var n=this.findAuthByAgent(e,t);i=n&&this.checkOrigin(n)&&n.allowsMode(r)}return Promise.resolve(i)}},{key:"checkOrigin",value:function(t){return!this.strictOrigin||!this.origin||this.origin===this.host||t.allowsOrigin(this.origin)}},{key:"clear",value:function(t){if(t=t||this.webClient,!t)return Promise.reject(new Error("Cannot clear - no web client"));var e=this.aclUrl;return e?t.del(e):Promise.reject(new Error("Cannot clear - unknown target url"))}},{key:"equals",value:function(t){var e=this,r=this.resourceUrl===t.resourceUrl,i=this.aclUrl===t.aclUrl,n=this.resourceType===t.resourceType,s=Object.keys(this.authorizations),o=Object.keys(t.authorizations);if(s.length!==o.length)return!1;var a,u,p=!0;return s.forEach(function(r){a=e.authorizations[r],u=t.authorizations[r],u||(p=!1),a.equals(u)||(p=!1)}),r&&i&&n&&p}},{key:"findAuthByAgent",value:function(t,e){var r=arguments.length<=2||void 0===arguments[2]?y:arguments[2],i=this.index[r];if(!i[t])return!1;var n=i[t][c.ACCESS_TO],s=void 0;if(n&&(s=n[e]),s)return s;var o=i[t][c.DEFAULT],a=void 0;if(o&&(a=o[e],!a)){var u=Object.keys(o).sort().reverse(),p=!0,l=!1,h=void 0;try{for(var d,f=u[Symbol.iterator]();!(p=(d=f.next()).done);p=!0){var g=d.value;if(e.startsWith(g)){a=o[g];break}}}catch(m){l=!0,h=m}finally{try{!p&&f["return"]&&f["return"]()}finally{if(l)throw h}}}return a}},{key:"findPublicAuth",value:function(t){return this.findAuthByAgent(c.EVERYONE,t,m)}},{key:"forEach",value:function(t){var e=this;this.allAuthorizations().forEach(function(r){t.call(e,r)})}},{key:"initFromGraph",value:function(t){var e=this,r=l(this.rdf),i=t.match(null,null,r.acl("Authorization"));i.length?i=i.map(function(t){return t.subject}):!function(){var e={};i=t.match(null,r.acl("mode")),i.forEach(function(t){e[t.subject.value]=t.subject}),i=Object.keys(e).map(function(t){return e[t]})}(),i.forEach(function(i){var n=t.match(i,r.acl("mode")),s=t.match(i,r.acl("origin")),a=t.match(i,r.acl("agent")),u=a.filter(o);a=a.filter(function(t){return!o(t)});var p=t.match(i,r.acl("agentClass"),r.foaf("Agent")),l=t.match(i,r.acl("agentGroup")),h=a.concat(p).concat(l);h.forEach(function(o){var a=t.match(i,r.acl("accessTo"));a.forEach(function(t){var r=t.object.value;e.addAuthorizationFor(r,c.NOT_INHERIT,o,n,s,u)});var p=t.match(i,r.acl("default")).concat(t.match(i,r.acl("defaultForNew")));p.forEach(function(t){var r=t.object.value;e.addAuthorizationFor(r,c.INHERIT,o,n,s,u)})})})}},{key:"isAuthInherited",value:function(){return this.resourceType===g}},{key:"isEmpty",value:function(){return 0===this.count}},{key:"permissionFor",value:function(t,e){if(!t)return null;e=e||this.resourceUrl;var r=u.hashFragmentFor(t,e);return this.authorizations[r]}},{key:"removeAuthorization",value:function(t){var e=t.hashFragment();return delete this.authorizations[e],this}},{key:"removePermission",value:function(t,e){var r=this.permissionFor(t,this.resourceUrl);return r?(r.removeMode(e),r.isEmpty()&&this.removeAuthorization(r),this):this}},{key:"save",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=e.aclUrl||this.aclUrl,i=e.contentType||d;return r?this.webClient?this.serialize({contentType:i}).then(function(e){return t.webClient.put(r,e,i)}):Promise.reject(new Error("Cannot save - no web client")):Promise.reject(new Error("Cannot save - unknown target url"))}},{key:"serialize",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.contentType||d,r=t.rdf||this.rdf;if(!r)return Promise.reject(new Error("Cannot save - no rdf library"));var i=this.buildGraph(r),n=null,s=null;return new Promise(function(t,o){r.serialize(n,i,s,e,function(r,i){return r?o(r):i?void t(i):o(new Error("Error serializing the graph to "+e))})})}},{key:"count",get:function(){return Object.keys(this.authorizations).length}}]),t}();v.RESOURCE=f,v.CONTAINER=g,t.exports=v},function(t,e,r){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){var r=arguments.length<=2||void 0===arguments[2]?u.ACCESS_TO:arguments[2],i=t+"-"+e+"-"+r;return i}var s=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),o=r(35),a=r(37),u=a.acl,p=function(){function t(e,r){i(this,t),this.accessModes={},this.accessType=r?u.DEFAULT:u.ACCESS_TO,this.agent=null,this.group=null,this.inherited=r,this.mailTo=[],this.originsAllowed={},this.resourceUrl=e,this.virtual=!1}return s(t,[{key:"addMailTo",value:function(t){"string"!=typeof t&&(t=t.object.value),t.startsWith("mailto:")&&(t=t.split(":")[1]),this.mailTo.push(t),this.mailTo.sort()}},{key:"addMode",value:function(t){var e=this;return Array.isArray(t)?t.forEach(function(t){e.addModeSingle(t)}):this.addModeSingle(t),this}},{key:"addModeSingle",value:function(t){return"string"!=typeof t&&(t=t.object.value),this.accessModes[t]=!0,this}},{key:"addOrigin",value:function(t){var e=this;return Array.isArray(t)?t.forEach(function(t){e.addOriginSingle(t)}):this.addOriginSingle(t),this}},{key:"addOriginSingle",value:function(t){return"string"!=typeof t&&(t=t.object.value),this.originsAllowed[t]=!0,this}},{key:"allModes",value:function(){return Object.keys(this.accessModes)}},{key:"allOrigins",value:function(){return Object.keys(this.originsAllowed)}},{key:"allowsMode",value:function(t){return t=u[t.toUpperCase()]||t,t===u.APPEND?this.allowsAppend():this.accessModes[t]}},{key:"allowsOrigin",value:function(t){return t in this.originsAllowed}},{key:"allowsRead",value:function(){return this.accessModes[u.READ]}},{key:"allowsWrite",value:function(){return this.accessModes[u.WRITE]}},{key:"allowsAppend",value:function(){return this.accessModes[u.APPEND]||this.accessModes[u.WRITE]}},{key:"allowsControl",value:function(){return this.accessModes[u.CONTROL]}},{key:"clone",value:function(){var e=new t;return Object.assign(e,JSON.parse(JSON.stringify(this))),e}},{key:"equals",value:function(t){var e=this.agent===t.agent,r=this.group===t.group,i=this.resourceUrl===t.resourceUrl,n=Object.keys(this.accessModes),s=Object.keys(t.accessModes),o=n.length===s.length,a=JSON.stringify(this.inherited)===JSON.stringify(t.inherited),u=!0;n.forEach(function(e){t.accessModes[e]||(u=!1)});var p=JSON.stringify(this.mailTo)===JSON.stringify(t.mailTo),c=JSON.stringify(this.originsAllowed)===JSON.stringify(t.originsAllowed);return e&&r&&i&&o&&u&&a&&p&&c}},{key:"hashFragment",value:function e(){if(!this.webId||!this.resourceUrl)throw new Error("Cannot call hashFragment() on an incomplete authorization");var e=n(this.webId(),this.resourceUrl,this.accessType);return e}},{key:"isAgent",value:function(){return this.agent}},{key:"isEmpty",value:function(){return 0===Object.keys(this.accessModes).length}},{key:"isPublic",value:function(){return this.group===u.EVERYONE}},{key:"isGroup",value:function(){return this.group}},{key:"isInherited",value:function(){return this.inherited}},{key:"isValid",value:function(){return this.webId()&&this.resourceUrl&&!this.isEmpty()}},{key:"mergeWith",value:function(t){if(this.hashFragment()!==t.hashFragment())throw new Error("Cannot merge authorizations with different agent id or resource url (accessTo)");for(var e in t.accessModes)this.addMode(e)}},{key:"rdfStatements",value:function(t){if(!this.webId()||!this.resourceUrl)return[];if(this.virtual)return[];var e,r=t.namedNode("#"+this.hashFragment()),i=o(t),n=[t.triple(r,i.rdf("type"),i.acl("Authorization"))];this.agent&&(e=t.triple(r,i.acl("agent"),t.namedNode(this.agent)),n.push(e)),this.mailTo.length>0&&this.mailTo.forEach(function(s){e=t.triple(r,i.acl("agent"),t.namedNode("mailto:"+s)),n.push(e)}),this.group&&(e=t.triple(r,i.acl("agentClass"),t.namedNode(this.group)),n.push(e)),e=t.triple(r,i.acl("accessTo"),t.namedNode(this.resourceUrl)),n.push(e);var s=Object.keys(this.accessModes);return s.forEach(function(s){e=t.triple(r,i.acl("mode"),t.namedNode(s)),n.push(e)}),this.inherited&&(e=t.triple(r,i.acl("defaultForNew"),t.namedNode(this.resourceUrl)),n.push(e)),this.allOrigins().forEach(function(s){e=t.triple(r,i.acl("origin"),t.namedNode(s)),n.push(e)}),n}},{key:"removeMode",value:function(t){var e=this;return Array.isArray(t)?t.forEach(function(t){e.removeModeSingle(t)}):this.removeModeSingle(t),this}},{key:"removeModeSingle",value:function(t){"string"!=typeof t&&(t=t.object.value),delete this.accessModes[t]}},{key:"removeOrigin",value:function(t){var e=this;return Array.isArray(t)?t.forEach(function(t){e.removeOriginSingle(t)}):this.removeOriginSingle(t),this}},{key:"removeOriginSingle",value:function(t){"string"!=typeof t&&(t=t.object.value),delete this.originsAllowed[t]}},{key:"setAgent",value:function(t){if("string"!=typeof t&&(t=t.object.value),t===u.EVERYONE)this.setPublic();else if(this.group)throw new Error("Cannot set agent, authorization already has a group set");t.startsWith("mailto:")?this.addMailTo(t):this.agent=t}},{key:"setGroup",value:function(t){if("string"!=typeof t&&(t=t.object.value),this.agent)throw new Error("Cannot set group, authorization already has an agent set");this.group=t}},{key:"setPublic",value:function(){this.setGroup(u.EVERYONE)}},{key:"webId",value:function(){return this.agent||this.group}}]),t}();p.hashFragmentFor=n,t.exports=p},[42,36],11,function(t,e,r){"use strict";var i=r(35),n=i(),s=n.acl("Read"),o=n.acl("Write"),a=n.acl("Append"),u=n.acl("Control"),p=n.foaf("Agent"),c=[s,o,u],l=!0,h=!l,d="accessTo",f="default";t.exports.acl={ALL_MODES:c,READ:s,WRITE:o,APPEND:a,CONTROL:u,EVERYONE:p,INHERIT:l,NOT_INHERIT:h,ACCESS_TO:d,DEFAULT:f}},function(t,e){"use strict";t.exports={authEndpoint:"https://databox.me/",signupEndpoint:"https://solid.github.io/solid-idps/",signupWindowHeight:600,signupWindowWidth:1024}},function(t,e,r){"use strict";var i=r(40);t.exports.version=function(){return i.version}},function(t,e){t.exports={name:"solid-client",version:"0.22.5",description:"Common library for writing Solid read-write-web applications",main:"./lib/index.js",files:["config.js","lib","dist"],scripts:{"build-lib":"babel src -d lib","build-full":"webpack --progress --config webpack.config.js --output-filename solid-client-full.js","build-with-rdflib":"webpack --progress --colors --optimize-minimize --optimize-occurrence-order --optimize-dedupe --config webpack.config.js","build-without-rdflib":"webpack --progress --colors --optimize-minimize --optimize-occurrence-order --optimize-dedupe --config webpack-no-rdflib.config.js","build-qunit-resources":"npm run clean && mkdir -p dist/resources && npm run build-full && browserify -r ./test/resources/profile-minimal.js:test-minimal-profile -o dist/resources/test-minimal-profile.js && browserify -r ./test/resources/profile-private.js:test-minimal-prefs -o dist/resources/test-minimal-prefs.js",build:"npm run clean && mkdir dist && npm run build-lib && npm run build-with-rdflib && npm run build-without-rdflib",clean:"rm -rf dist/",standard:"standard src/*",tape:"tape test/unit/*.js",test:"npm run standard && npm run tape",qunit:"npm run build-qunit-resources && open test/integration/index.html",preversion:"npm test",postversion:"git push --follow-tags",prepublish:"npm run test && npm run build"},babel:{presets:["es2015"]},repository:{type:"git",url:"https://github.com/solid/solid-client"},keywords:["solid","decentralized","web","rdf","ldp","linked","data"],author:"Andrei Sambra <andrei@fcns.eu>",maintainers:[{name:"Dmitri Zagidulin",url:"https://github.com/dmitrizagidulin/"}],license:"MIT",bugs:{url:"https://github.com/solid/solid-client/issues"},homepage:"https://github.com/solid/solid-client",dependencies:{"babel-cli":"^6.18.0","babel-preset-es2015":"^6.18.0",rdflib:"^0.12.1",shorthash:"0.0.2","solid-auth-tls":"0.0.4","solid-namespace":"^0.1.0","solid-permissions":"^0.5.0","solid-web-client":"0.0.9"},devDependencies:{"json-loader":"^0.5.4",qunit:"^0.9.0",standard:"^5.4.1",tape:"^4.4.0",webpack:"^1.13.1"},standard:{globals:["$rdf","SolidClient","tabulator","QUnit"]}}},function(t,e){"use strict";function r(){return window.navigator.onLine}function i(t){window.addEventListener("offline",t,!1)}function n(t){window.addEventListener("online",t,!1)}t.exports.isOnline=r,t.exports.onOffline=i,t.exports.onOnline=n},function(t,e,r,i){"use strict";function n(t){var e=r(i)(t),n={acl:e.base("http://www.w3.org/ns/auth/acl#"),app:e.base("http://www.w3.org/ns/solid/app#"),cert:e.base("http://www.w3.org/ns/auth/cert#"),dct:e.base("http://purl.org/dc/terms/"),foaf:e.base("http://xmlns.com/foaf/0.1/"),ldp:e.base("http://www.w3.org/ns/ldp#"),owl:e.base("http://www.w3.org/2002/07/owl#"),pim:e.base("http://www.w3.org/ns/pim/space#"),rdf:e.base("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),rdfs:e.base("http://www.w3.org/2000/01/rdf-schema#"),schema:e.base("http://schema.org/"),sioc:e.base("http://rdfs.org/sioc/ns#"),solid:e.base("http://www.w3.org/ns/solid/terms#"),stat:e.base("http://www.w3.org/ns/posix/stat#"),vcard:e.base("http://www.w3.org/2006/vcard/ns#"),xsd:e.base("http://www.w3.org/2001/XMLSchema#")};return n}t.exports=n}]));
//# sourceMappingURL=solid-client-lite.min.js.map